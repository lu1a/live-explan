<!DOCTYPE html>
<html>

<head>
	<title>Lewis Torrington</title>
	<style>
		html {
			font-size: 100%;
			-ms-touch-action: manipulation;
			touch-action: manipulation;
		}

		body {
			margin: 0;
			padding: 0;
			background: linear-gradient(to top, #040308, #AD4A28, #DD723C, #FC7001, #DCB697, #9BA5AE, #3E5879, #020B1A);
			font-family: "Fira Code", monospace;
			font-size: 1rem;
		}

		.terminal {
			background-color: #272727;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			border: 1px solid #333333;
			border-radius: 5px;
			overflow: hidden;
			width: 80%;
			height: 80%;
			display: flex;
			flex-direction: column;

			transition: height 0.2s ease, width 0.2s ease;
		}

		.top-bar {
			display: flex;
			flex-direction: row;
			background-color: #444444;
			height: 2rem;
			align-items: center;
			padding: 0 10px;
			user-select: none;
		}

		.title {
			color: white;
			font-size: 1rem;
			margin-left: 10px;
			flex-grow: 1;
		}

		.button {
			width: 0.7rem;
			height: 0.7rem;
			border-radius: 50%;
			margin-right: 7px;
			user-select: none;
		}

		.red {
			background-color: #FF605C;
			background-color: color(display-p3 1 0.4 0.36);
		}

		.grey {
			background-color: #c6c6c6;
		}

		.green {
			background-color: #00CA4E;
			background-color: color(display-p3 0 0.79 0.31);
		}

		.tab-bar {
			display: flex;
			flex-direction: row;
			background-color: #444444;
			height: 1.9rem;
			align-items: center;
			padding-top: 0.4rem;
			user-select: none;
		}

		.tab {
			color: white;
			font-size: 0.9rem;
			user-select: none;
			cursor: pointer;
			background-color: #444444;
			border: none;
			padding: 0.4rem 1rem;

			transition: background-color 0.1s, color 0.1s;
		}

		.tab.active {
			background-color: #6e6e6e;
		}

		.tab:hover {
			background-color: white;
			color: black;
		}

		.tab:active {
			background-color: grey;
			color: white;
		}

		.terminal-content {
			position: absolute;
			top: 70px;
			left: 0;
			width: 100%;
			height: calc(100% - 30px);
			overflow-y: scroll;
			padding: 10px;
		}

		.terminal-maximized {
			width: 100%;
			height: 100%;
		}

		.command {
			color: #00ff00;
			color: color(display-p3 0 1 0);
		}

		.output {
			color: white;
		}

		.terminal-content [data-tab]:not(.active) {
			display: none;
		}

		.input-container {
			display: flex;
			margin-bottom: 5px;
		}

		.input-container textarea,
		.input-container input[type="email"] {
			margin-left: 10px;
			background-color: transparent;
			border: none;
			width: 100%;
			font-family: "Fira Code", monospace;
			font-size: 1rem;
			color: white;
		}

		.grow-wrap {
			/* easy way to plop the elements on top of each other and have them both sized based on the tallest one's height */
			display: grid;
			width: 50vw;
		}

		.grow-wrap::after {
			/* Note the weird space! Needed to preventy jumpy behavior */
			content: attr(data-replicated-value) " ";
			white-space: pre-wrap;
			visibility: hidden;
		}

		.grow-wrap>textarea {
			resize: none;
			overflow: hidden;
		}

		.grow-wrap>textarea,
		.grow-wrap::after {
			/* Identical styling required!! */
			padding: 0.5rem;
			font: inherit;
			grid-area: 1 / 1 / 2 / 2;
		}

		ul {
			list-style-type: '- ';
		}

		.cta {
			background-color: transparent;
			font-family: "Fira Code", monospace;
			font-size: 1rem;
			border: 1px solid #00ff00;
			transition: background-color 0.1s, color 0.1s;
		}

		.cta:hover {
			background-color: white;
			color: black;
		}

		.cta:active {
			background-color: grey;
			color: white;
		}
	</style>
</head>

<body>
	<div class="terminal">
		<div class="top-bar">
			<div class="button red terminal-red"></div>
			<div class="button grey terminal-grey"></div>
			<div class="button green terminal-green"></div>
			<div class="title"></div>
		</div>
		<div class="tab-bar">
			<button class="tab active" data-tab="description">Description</button>
			<button class="tab" data-tab="contact">Contact</button>
			<button class="tab" data-tab="resources">Resources</button>
		</div>
		<div class="terminal-content">
			<div class="output active" id="welcome">Welcome to my page!</div>
			<div class="output active" data-tab="description">$ echo "Hello, World!"</div>
			<div class="output active" data-tab="description">Hello, World!</div>
			<div class="output active" data-tab="description">$ ls</div>
			<div class="output active" data-tab="description">file1.txt file2.txt</div>
			<div class="command active" data-tab="description">$ cat file1.txt</div>
			<br class="active" data-tab="description" />
			<div class="output active" data-tab="description">
				Hello, my name is Lewis Torrington and this is my page.
				About me:
				<ul style="margin: 0;padding-inline-start: 20px;">
					<li>From Australia; living in Finland since 2019.</li>
					<li>Working at <a style="color: white;" href="https://www.upcloud.com/" target="_blank">UpCloud</a>
					</li>
					<li>Fullstack developer:</li>
					<ul>
						<li>Backend: Go, Python, C++ (learning Rust)</li>
						<li>Frontend: React, Vue, WASM, etc</li>
					</ul>
				</ul>
			</div>
			<br class="active" data-tab="description" />
			<div class="command active" data-tab="description"><a style="color: white;" href="https://github.com/lu1a"
					target="_blank">https://github.com/lu1a</a></div>
			<div class="command active" data-tab="description"><a style="color: white;"
					href="https://www.linkedin.com/in/lewis-torrington/"
					target="_blank">https://www.linkedin.com/in/lewis-torrington/</a></div>


			<form id="contact-form" enctype="multipart/form-data">
				<div class="output" data-tab="contact">$ send_msg_to_lewis</div>
				<div class="output" data-tab="contact">&nbsp;&nbsp;-subject: Contact request</div>
				<div class="output" data-tab="contact">
					<div class="input-container">
						<span>&nbsp;&nbsp;-email_address: </span>
						<span><input style="width:50vw" type="email" name="sender_address" value=""
								autocomplete="email"></span>
					</div>
				</div>
				<div class="output" data-tab="contact">
					<div class="input-container">
						<span>&nbsp;&nbsp;-message: </span>
						<div class="grow-wrap">
							<textarea name="content" id="text" style="width: 50vw;"
								onInput="this.parentNode.dataset.replicatedValue = this.value"></textarea>
						</div>
					</div>
				</div>
				<div class="command" data-tab="contact">
					<div class="input-container">
						<span>&nbsp;&nbsp;Send?&nbsp;</span>
						<div>
							<span>(</span>
							<button class="command cta" type="submit" name="send-cmd" value="y">y</button>
							<span>/</span>
							<button class="command cta" type="button" name="send-cmd" value="n">n</button>
							<span>)</span>
						</div>
					</div>
				</div>
				<div class="output" id="message-container" data-tab="contact"></div>
			</form>

			<div class="output" data-tab="resources">Resource links and information go here.</div>
		</div>
	</div>
</body>
<script>
	// Set the title in the top bar
	document.querySelector(".title").textContent = document.title;

	// display date and time in desired format
	const welcomestr = document.getElementById("welcome");
	const now = new Date().toISOString();
	welcomestr.innerHTML = now.slice(0, 10) + " " + now.slice(11, 19) + " Welcome to my page!";

	// get elements
	const terminal = document.querySelector(".terminal");
	const redButton = document.querySelector(".terminal-red");
	const greyButton = document.querySelector(".terminal-grey");
	const greenButton = document.querySelector(".terminal-green");
	const tabs = document.querySelectorAll('.tab');
	const content = document.querySelector(".terminal-content");

	// handle red button click
	redButton.addEventListener("click", function () {
		alert("Close this tab in your browser as normal ðŸ¤·")
	});

	// handle grey button click
	greyButton.addEventListener("click", function () {
		// do nothing
	});

	// handle green button click
	greenButton.addEventListener("click", function () {
		if (terminal.classList.contains("terminal-maximized")) {
			// minimize
			terminal.classList.remove("terminal-maximized");
			content.style.height = "calc(100% - 30px)";
		} else {
			// maximize
			terminal.classList.add("terminal-maximized");
			content.style.height = "calc(100% - 60px)";
		}
	});

	// check if device width is less than or equal to 768px (mobile size)
	if (window.matchMedia("(max-width: 1179px)").matches) {
		// execute code for mobile devices (maximize terminal)
		terminal.classList.add("terminal-maximized");
		content.style.height = "calc(100% - 60px)";
	}

	tabs.forEach(tab => {
		tab.addEventListener('click', () => {
			const tabName = tab.getAttribute('data-tab');
			const contentElements = document.querySelectorAll(`.terminal-content [data-tab]`);
			tabs.forEach(t => t.classList.remove('active'));
			contentElements.forEach(content => content.style.display = 'none');
			tab.classList.add('active');
			contentElements.forEach(content => {
				if (content.getAttribute('data-tab') === tabName) {
					content.style.display = 'block';
				}
			});
		});
	});

	// Contact request below, trying to use as little BS as possible.

	const form = document.querySelector('#contact-form');

	form.addEventListener('submit', (event) => {
		event.preventDefault(); // Prevent the default form submission

		const formData = new FormData(form); // Get the form data
		const xhr = new XMLHttpRequest(); // Create a new XMLHttpRequest object

		xhr.open('POST', '/contact'); // Set the request method and URL
		xhr.onload = () => { // Define the callback for a successful request
			const messageContainer = document.querySelector('#message-container');

			if (xhr.status === 200) {
				const successMsg = document.createElement('div');
				successMsg.classList.add('msg-send-success');
				successMsg.textContent = `$ Message sent successfully at ${new Date().toISOString()}.`;
				messageContainer.appendChild(successMsg);
			} else {
				const errorMsg = document.createElement('div');
				errorMsg.classList.add('msg-send-error');
				const response = JSON.parse(xhr.responseText); // parse the response text as JSON
				errorMsg.textContent = `$ ERROR sending message: ${response.error}`; // display the error message from the server

				messageContainer.appendChild(errorMsg);
			}
		};
		xhr.send(formData); // Send the form data in the request body
	});
</script>

</html>